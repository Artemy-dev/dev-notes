# Полный гайд по основам сетей

## Основные протоколы и их порты

Протокол - это "язык", на котором общаются устройства в сети. Вот самые ходовые:

| Протокол     | Порт       | Что делает                                           |
|-------------|------------|-----------------------------------------------------|
| HTTP        | 80         | Передача веб-страниц без шифрования                |
| HTTPS       | 443        | То же, но по защищённому каналу (SSL/TLS)          |
| FTP         | 21         | Передача файлов                                     |
| SSH         | 22         | Безопасное подключение к серверу                   |
| SMTP        | 25         | Отправка почты                                     |
| IMAP / POP3 | 143 / 110  | Получение почты                                    |
| DNS         | 53         | Преобразует домен в IP                             |
| DHCP        | 67 / 68    | Выдаёт устройствам IP-адреса                        |
| NTP         | 123        | Синхронизация времени                               |
| Redis       | 6379       | Кэш и быстрая база данных                           |
| PostgreSQL  | 5432       | SQL база данных                                     |

## Модель TCP/IP (4 уровня)

Современная, упрощённая версия сетевой модели. Всё, что реально работает в интернете.

1. **Канальный (Link)** - физическое соединение: Ethernet, Wi-Fi, MAC-адреса.
2. **Сетевой (Internet)** - доставка пакетов: IP, маршрутизация, ICMP.
3. **Транспортный (Transport)** - надёжная передача данных: TCP, UDP.
4. **Прикладной (Application)** - то, что видит программа: HTTP, DNS, SMTP и т.п.

## Модель OSI (7 уровней)

Более подробная (и теоретическая) модель. TCP/IP - это её "сжатая" версия.

1. **Физический** - кабели, сигналы, биты.
2. **Канальный** - MAC, Ethernet, ARP.
3. **Сетевой** - IP, маршрутизация.
4. **Транспортный** - TCP, UDP, порты.
5. **Сеансовый** - управление сессиями (редко трогаем напрямую).
6. **Представительный уровень** - кодировки, шифрование, сжатие.
7. **Прикладной** - HTTP, FTP, DNS и т.д.

## Как данные идут по сети

Чтобы понять, как работают модели TCP/IP и OSI на практике, можно пройти путь пакета:

```txt
Приложение → TCP → IP → Ethernet → маршрутизатор → интернет → сервер
```

Это простое пошаговое представление помогает связать теорию (модели) с практикой (передача данных).

- **Приложение** - браузер, API-клиент или почтовая программа.
- **TCP** - надёжная доставка, нумерация пакетов, подтверждения.
- **IP** - адресация, маршрутизация пакетов.
- **Ethernet** - физическая передача по кабелю или Wi-Fi.
- **Маршрутизатор** - решает, куда отправить пакет дальше.
- **Интернет** - глобальная сеть, через которую пакет движется к серверу.
- **Сервер** - конечная точка, которая принимает и обрабатывает запрос.

## Этапы работы DHCP

**DHCP** - сервис, который автоматически выдаёт IP-адреса. Работает в 4 шага (DORA):

1. **Discover** - клиент ищет сервер: "Есть тут кто? Мне нужен IP!"
2. **Offer** - сервер предлагает IP.
3. **Request** - клиент говорит: "Беру этот!"
4. **Acknowledge** - сервер подтверждает: "Ок, твой IP - 192.168.0.42."

## Коды HTTP-ответов (по группам)

Сервер всегда что-то отвечает. Первые цифры кода - "тип ответа":

| Код   | Описание                |
|-------|------------------------|
| `1xx` | Информационные (редко видим) |
| `2xx` | Успех                  |
| `3xx` | Перенаправления        |
| `4xx` | Ошибки клиента         |
| `5xx` | Ошибки сервера         |

## Популярные коды HTTP-ответов

| Код  | Сообщение                               |
|------|----------------------------------------|
| `200 OK`  | Всё хорошо, запрос успешно обработан        |
| `201 Created` | Новый ресурс создан                     |
| `204 No Content` | Всё ок, но возвращать нечего          |
| `301 Moved Permanently` | Навсегда перенаправлено           |
| `302 Found` | Временное перенаправление                |
| `400 Bad Request` | Неправильный запрос                  |
| `401 Unauthorized` | Нет авторизации                     |
| `403 Forbidden` | Доступ запрещён                       |
| `404 Not Found` | Не найдено                           |
| `500 Internal Server Error` | Ошибка на сервере               |
| `502 Bad Gateway` | Сервер-посредник получил ерунду     |
| `503 Service Unavailable` | Сервер временно недоступен       |

## Методы HTTP-запросов

| Метод   | Что делает                               |
|---------|-----------------------------------------|
| `GET`    | Получить данные                         |
| `POST`   | Отправить данные                        |
| `PUT`    | Полностью обновить ресурс               |
| `PATCH`  | Частично обновить                        |
| `DELETE` | Удалить                                  |
| `HEAD`   | Только заголовки (без тела ответа)      |
| `OPTIONS`| Узнать, что вообще можно делать с ресурсом |

## DNS - как сайт превращается из имени в IP

**DNS (Domain Name System)** - делает имена понятными людям, а адреса - понятными машинам. Когда ты вводишь google.com, браузер спрашивает у DNS-сервера: "Какой у этого имени IP-адрес?", DNS отвечает, например: 142.250.186.206.

| Тип записи | Что делает                                      |
|------------|------------------------------------------------|
| `A`        | Домен → IPv4-адрес                             |
| `AAAA`     | Домен → IPv6-адрес                             |
| `CNAME`    | Псевдоним (например, `www` → `site.com`)      |
| `MX`       | Почтовый сервер домена                          |
| `TXT`      | Произвольный текст (часто для подтверждения домена) |

## Ping и Traceroute - диагностика сети

Эти инструменты помогают понять, жива ли сеть и где пропадает связь.

- **Ping** - посылает "эхо-запрос" и ждёт "эхо-ответ". Показывает, доступен ли хост и за сколько миллисекунд пришёл ответ. Пример: ping google.com
- **Traceroute (в Windows - tracert)** - показывает весь путь, по которому проходят пакеты до сервера. Можно увидеть, где "теряется" запрос.

## SSL / TLS - шифрование трафика

SSL (старый протокол) и его улучшенная версия TLS 1.2/1.3 - отвечают за безопасность данных между клиентом и сервером. Он обеспечивает:

1. **Шифрование** - никто не подслушает.
2. **Аутентификацию** - ты точно общаешься с тем сайтом, который хотел.
3. **Целостность** - данные не были подменены по пути.

*Без TLS - данные передаются "в открытую", с TLS - даже Wi-Fi в кафе не узнает, что ты отправил.*

## Proxy и VPN - переадресация и защита трафика

Оба служат для переадресации трафика, но работают на разных уровнях.

- **Proxy** - посредник между тобой и сайтом. Браузер отправляет запрос не прямо на сайт, а через прокси, как "пересылка писем через друга". Можно кешировать, фильтровать, менять IP, обходить блокировки.
- **VPN** (Virtual Private Network) - создаёт зашифрованный туннель между тобой и удалённым сервером, как "личный зашифрованный канал связи". Всё, что ты делаешь в интернете, идёт через этот туннель. VPN шифрует весь трафик (не только браузер) и скрывает реальный IP.

## TCP и UDP - надёжность и различия

- **TCP (Transmission Control Protocol)** - надёжный, ориентированный на соединение.
- **UDP (User Datagram Protocol)** - быстрый, но без гарантий доставки.

| Параметр       | TCP                          | UDP                          |
|----------------|-----------------------------|-----------------------------|
| Тип соединения | Ориентированное             | Без соединения              |
| Доставка       | Гарантированная             | Не гарантируется            |
| Скорость       | Медленнее                    | Быстрее                     |
| Использование  | `HTTP`, `SSH`, `FTP`        | `DNS`, `VoIP`, видео, игры |

*TCP использует "трёхстороннее рукопожатие" (3-way handshake): SYN → SYN-ACK → ACK - чтобы установить надёжное соединение. Каждый пакет нумеруется и получатель подтверждает.*

## NAT, Subnetting и CIDR

- **NAT (Network Address Translation)** - преобразует приватные IP (внутренние) в один публичный. Благодаря NAT десятки устройств могут использовать один внешний IP.
- **Subnetting** - деление сети на подсети для оптимизации маршрутизации. Например, 192.168.1.0/24 → 256 адресов (0–255).
- **CIDR (Classless Inter-Domain Routing)** - способ записывать маску сети: /24 = 255.255.255.0, /16 = 255.255.0.0 и т.д.

## Firewall, iptables и маршрутизация

- **Firewall** - фильтрует пакеты по правилам: кто, куда, и как может подключаться.
- **iptables (Linux)** - инструмент настройки правил на уровне ядра.
Маршрутизация - определяет путь пакетов между сетями.

## Балансировка и Reverse Proxy

Используется для: масштабирования, кэширования, SSL-терминации, скрытия внутренней инфраструктуры.

- **Load Balancer** - распределяет нагрузку между несколькими серверами (например, Nginx, HAProxy).
- **Reverse Proxy** - принимает запросы клиентов и перенаправляет на backend-серверы.

## TLS - handshake и сертификаты

TLS обеспечивает защищённый канал связи. Процесс начинается с TLS Handshake:

1. Клиент отправляет "Hello" и список поддерживаемых шифров.
2. Сервер отвечает своим сертификатом и шифром.
3. Клиент проверяет сертификат через доверенный CA (Certificate Authority).
4. Оба договариваются о ключе шифрования.
После handshake создаются session keys, которыми шифруется весь последующий трафик.
Certificate Chain - цепочка доверия от конечного сертификата до корневого Certificate Authority.
